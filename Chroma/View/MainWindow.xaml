<Window x:Class="Chroma.MainWindow"
		xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
		xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
		xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
		xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
		xmlns:local="clr-namespace:Chroma"
		xmlns:sys="clr-namespace:System;assembly=mscorlib"
		xmlns:vm="clr-namespace:Chroma.ViewModel"
		mc:Ignorable="d"
		Title="Chroma"
		Height="360" Width="550"
		MinWidth="300" MinHeight="360"
		MaxWidth="800" MaxHeight="700"
		WindowStartupLocation="CenterScreen"
		Topmost="{Binding IsOnTop}">
	<Window.DataContext>
		<vm:MainWindowViewModel/>
	</Window.DataContext>
	<Window.Resources>
		<ResourceDictionary>
			<ResourceDictionary.MergedDictionaries>
				<ResourceDictionary Source="Resources.xaml"/>
			</ResourceDictionary.MergedDictionaries>
		</ResourceDictionary>
	</Window.Resources>
	<Grid IsEnabled="{Binding IsColourPicker, Converter={StaticResource booleanInverter}}" TextBlock.FontFamily="{StaticResource MainFont}">
		<Grid.ColumnDefinitions>
			<ColumnDefinition MinWidth="100" Width="5*"/>
			<ColumnDefinition Width="8"/>
			<ColumnDefinition MinWidth="50" Width="200"/>
		</Grid.ColumnDefinitions>
		<Grid>
			<Grid.Resources>
				<Style x:Key="ColourEditControl" TargetType="{x:Type Control}">
					<Style.Triggers>
						<DataTrigger Binding="{Binding CurrentColour}" Value="{x:Null}">
							<Setter Property="IsEnabled" Value="False"/>
						</DataTrigger>
					</Style.Triggers>
				</Style>
			</Grid.Resources>
			<Grid.RowDefinitions>
				<RowDefinition Height="100"/>
				<RowDefinition Height="*"/>
			</Grid.RowDefinitions>
			<DockPanel Margin="10">
				<!-- Action buttons. -->
				<StackPanel Margin="0 0 5 0" Height="50" VerticalAlignment="Top" DockPanel.Dock="Left">
					<StackPanel.Resources>
						<Style TargetType="{x:Type Button}" BasedOn="{StaticResource ColourEditControl}"/>
					</StackPanel.Resources>
					<!-- Randomize Button. -->
					<Button Content="?" Width="{Binding ActualHeight, RelativeSource={RelativeSource Self}}" Command="{Binding RandomizeColourButtonCommand}">
						<Button.ToolTip>
							<ToolTip Content="Randomize"/>
						</Button.ToolTip>
					</Button>
					<!-- Colour Picker Button. -->
					<Button Padding="0 2" Margin="0 4 0 0" Command="{Binding ColourPickerButtonCommand}">
						<Button.ToolTip>
							<ToolTip Content="Colour Picker"/>
						</Button.ToolTip>
						<Button.Content>
							<!-- Temporary icon placeholder. -->
							<Path
								Data="M 12.489974 0.510764 C 12.160557 0.18139 11.722564 0 11.256736 0 10.790907 0 10.352914 0.18139 10.023498 0.510764 L 7.1837003 3.350144 6.8913833 3.057866 C 6.7694603 2.935958 6.6191743 2.859794 6.4617323 2.829328 c -0.02624 -0.0051 -0.05269 -0.0089 -0.0792 -0.01141 -0.02651 -0.0027 -0.05317 -0.0038 -0.07977 -0.0038 -0.02661 0 -0.05326 0.0014 -0.07978 0.0038 -0.02651 0.0027 -0.05295 0.0064 -0.0792 0.01141 -0.157398 0.03046 -0.307727 0.106674 -0.429651 0.228538 v 0 c -0.06094 0.06093 -0.110464 0.128974 -0.148573 0.201495 -0.0127 0.02415 -0.02415 0.04882 -0.03429 0.07388 -0.03046 0.07515 -0.04952 0.153866 -0.05716 0.233411 -0.0027 0.02651 -0.0038 0.05316 -0.0038 0.07976 0 0.05325 0.0051 0.106499 0.01523 0.158958 0.01523 0.07871 0.04188 0.155622 0.07999 0.228099 0.03811 0.07248 0.08763 0.14052 0.148573 0.201496 l 0.189625 0.189599 -4.96206103 4.961497 c -0.06296 0.06295 -0.112528 0.137974 -0.145588 0.220592 l -0.710817 1.772945 c -0.146027 0.364273 -0.102649 0.774728 0.116084 1.098043 0.22128 0.327091 0.586391 0.522353 0.97661603 0.522353 0.15068 0 0.299298 -0.02894 0.441812 -0.08609 l 1.773178 -0.710723 c 0.08263 -0.03309 0.157705 -0.08266 0.220621 -0.145569 l 4.962149 -4.961497 0.18958 0.189556 c 0.02033 0.02033 0.04145 0.03938 0.06322 0.05716 0.0436 0.03556 0.08996 0.06602 0.138299 0.09144 0.120826 0.06348 0.253989 0.09522 0.387152 0.09522 v 0 c 0.0014 0 0.0027 -1.76e-4 0.0038 -1.76e-4 0.07863 -3.37e-4 0.157179 -0.01158 0.233222 -0.03411 0.102956 -0.03046 0.201215 -0.08126 0.288409 -0.152373 0.02182 -0.01776 0.04289 -0.03683 0.06322 -0.05716 v 0 C 10.044217 7.18409 10.11407 7.062797 10.152135 6.934085 c 0.03046 -0.102943 0.04066 -0.210627 0.03046 -0.316774 -0.0051 -0.05307 -0.01523 -0.105709 -0.03046 -0.157202 -0.01523 -0.05149 -0.03556 -0.101758 -0.06094 -0.15009 -0.03811 -0.07248 -0.08763 -0.140521 -0.1485727 -0.201496 L 9.6503053 5.816244 12.490058 2.976863 c 0.679908 -0.679818 0.679908 -1.786158 -8.7e-5 -2.466108 z m -9.7123697 10.520239 -1.350683 0.541317 0.541432 -1.350462 4.866744 -4.866105 0.809251 0.809145 z"
								Width="13" Height="13"
								Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=Button}}"/>
						</Button.Content>
					</Button>
				</StackPanel>
				<Border CornerRadius="5" DockPanel.Dock="Right">
					<Border.Background>
						<SolidColorBrush Color="{Binding CurrentColour.Colour}"/>
					</Border.Background>
				</Border>
			</DockPanel>
			<Grid Grid.Row="1" Margin="10">
				<Grid.ColumnDefinitions>
					<ColumnDefinition Width="*"/>
					<ColumnDefinition Width="20"/>
				</Grid.ColumnDefinitions>
				<Grid.RowDefinitions>
					<RowDefinition Height="*"/>
				</Grid.RowDefinitions>
				<DockPanel Margin="0 0 10 0">
					<!-- Sliders -->
					<Grid Margin="0 0 10 0" DockPanel.Dock="Top">
						<Grid.Resources>
							<Style TargetType="{x:Type Slider}" BasedOn="{StaticResource ColourEditControl}">
								<Setter Property="Minimum" Value="0"/>
								<Setter Property="Maximum" Value="255"/>
								<Setter Property="Grid.Column" Value="1"/>
								<Setter Property="Margin" Value="0 2"/>
							</Style>
							<Style TargetType="{x:Type TextBlock}">
								<Setter Property="VerticalAlignment" Value="Center"/>
							</Style>
						</Grid.Resources>
						<Grid.ColumnDefinitions>
							<ColumnDefinition Width="18"/>
							<ColumnDefinition Width="*"/>
						</Grid.ColumnDefinitions>
						<Grid.RowDefinitions>
							<RowDefinition Height="*"/>
							<RowDefinition Height="*"/>
							<RowDefinition Height="*"/>
							<RowDefinition Height="*"/>
						</Grid.RowDefinitions>
						<!-- Alpha Slider -->
						<TextBlock Text="A"/>
						<Slider Value="{Binding A}"/>
						<!-- Red Slider -->
						<TextBlock Grid.Row="1" Text="R"/>
						<Slider Grid.Row="1" Value="{Binding R}" />
						<!-- Green Slider -->
						<TextBlock Grid.Row="2" Text="G"/>
						<Slider Grid.Row="2" Value="{Binding G}"/>
						<!-- Blue Slider -->
						<TextBlock Grid.Row="3" Text="B"/>
						<Slider Grid.Row="3" Value="{Binding B}"/>
					</Grid>
					<!-- Colour text boxes -->
					<Grid DockPanel.Dock="Top">
						<Grid.Resources>
							<Style TargetType="{x:Type TextBox}" BasedOn="{StaticResource ColourEditControl}">
								<Setter Property="Margin" Value="0 0 0 0"/>
								<Setter Property="Height" Value="18"/>
								<Setter Property="VerticalContentAlignment" Value="Center"/>
								<Style.Triggers>
									<DataTrigger Binding="{Binding CurrentColour}" Value="{x:Null}">
										<Setter Property="Foreground" Value="White"/>
									</DataTrigger>
								</Style.Triggers>
							</Style>
							<Style TargetType="{x:Type Button}">
								<Setter Property="Margin" Value="-1 0 0 0"/>
								<Setter Property="Panel.ZIndex" Value="1"/>
								<Setter Property="Width" Value="{Binding Path=ActualHeight, RelativeSource={RelativeSource Self}}"/>
							</Style>
						</Grid.Resources>
						<Grid.ColumnDefinitions>
							<ColumnDefinition Width="*"/>
							<ColumnDefinition Width="10"/>
							<ColumnDefinition Width="*"/>
						</Grid.ColumnDefinitions>
						<Grid.RowDefinitions>
							<RowDefinition Height="*"/>
							<RowDefinition Height="*"/>
							<RowDefinition Height="*"/>
							<RowDefinition Height="*"/>
						</Grid.RowDefinitions>
						<!-- RGB text box -->
						<TextBlock Text="RGB" Margin="0 0 0 2"/>
						<DockPanel Grid.Row="1">
							<Button DockPanel.Dock="Right" Command="{Binding CopyColourButtonCommand}" CommandParameter="{StaticResource rgbConverter}">
								<Path Style="{StaticResource copyIcon}"/>
							</Button>
							<TextBox Text="{Binding Colour, Converter={StaticResource rgbConverter}}"/>
						</DockPanel>
						<!-- ARGB text box -->
						<TextBlock Margin="0 4 0 2" Grid.Row="2" Text="ARGB"/>
						<DockPanel Grid.Row="3">
							<Button DockPanel.Dock="Right" Command="{Binding CopyColourButtonCommand}" CommandParameter="{StaticResource argbConverter}">
								<Path Style="{StaticResource copyIcon}"/>
							</Button>
							<TextBox Text="{Binding Colour, Converter={StaticResource argbConverter}}"/>
						</DockPanel>
						<!-- Hex text box -->
						<TextBlock Margin="0 0 0 2" Grid.Column="2" Text="Hex (RGB)"/>
						<DockPanel Grid.Column="2" Grid.Row="1">
							<Button DockPanel.Dock="Right" Command="{Binding CopyColourButtonCommand}" CommandParameter="{StaticResource hexConverter}">
								<Path Style="{StaticResource copyIcon}"/>
							</Button>
							<TextBox Text="{Binding Colour, Converter={StaticResource hexConverter}}"/>
						</DockPanel>
						<!-- Hex (Alpha) text box -->
						<TextBlock Margin="0 4 0 2" Grid.Column="2" Grid.Row="2" Text="Hex (ARGB)"/>
						<DockPanel Grid.Column="2" Grid.Row="3">
							<Button DockPanel.Dock="Right" Command="{Binding CopyColourButtonCommand}" CommandParameter="{StaticResource aHexConverter}">
								<Path Style="{StaticResource copyIcon}"/>
							</Button>
							<TextBox Text="{Binding Colour, Converter={StaticResource aHexConverter}}"/>
						</DockPanel>
					</Grid>
					<!-- This may be replaced with a different type of slider in the future. -->
					<Slider Value="{Binding Colour, Converter={StaticResource gradientScaleConverter}}" Margin="0 10 0 0" Minimum="0" Maximum="255" Height="20" DockPanel.Dock="Bottom" VerticalAlignment="Bottom">
						<Slider.Style>
							<Style TargetType="{x:Type Slider}" BasedOn="{StaticResource ColourEditControl}"/>
						</Slider.Style>
						<Slider.Background>
							<LinearGradientBrush StartPoint="0, 0" EndPoint="1, 0">
								<GradientStop Color="Black"/>
								<GradientStop Offset="1" Color="{Binding CurrentColour.Colour, Converter={StaticResource gradientConverter}}"/>
							</LinearGradientBrush>
						</Slider.Background>
					</Slider>
				</DockPanel>
				<!-- Colour spectrum slider -->
				<Border Grid.Column="1" BorderBrush="Black" BorderThickness="1">
					<Border.Background>
						<LinearGradientBrush StartPoint="0, 0" EndPoint="0, 1">
							<GradientStop Offset="0" Color="Red"/>
							<GradientStop Offset="0.2" Color="Yellow"/>
							<GradientStop Offset="0.4" Color="Green"/>
							<GradientStop Offset="0.6" Color="Cyan"/>
							<GradientStop Offset="0.8" Color="Blue"/>
							<GradientStop Offset="1" Color="Purple"/>
						</LinearGradientBrush>
					</Border.Background>
				</Border>
			</Grid>
		</Grid>
		<GridSplitter Width="8" Grid.Column="1" ResizeDirection="Columns" ResizeBehavior="PreviousAndNext">
			<GridSplitter.Template>
				<ControlTemplate>
					<Border Background="Transparent">
						<Border Width="2" Background="Black" Margin="0 10"/>
					</Border>
				</ControlTemplate>
			</GridSplitter.Template>
		</GridSplitter>
		<!-- Right Sidebar -->
		<Grid Grid.Column="2" Margin="10">
			<Grid.RowDefinitions>
				<RowDefinition Height="*"/>
				<RowDefinition Height="46"/>
				<RowDefinition Height="100"/>
			</Grid.RowDefinitions>
			<!-- Saved colours box -->
			<ListBox SelectedItem="{Binding CurrentColour}" SelectedIndex="0" ItemsSource="{Binding SavedColours}">
				<ListBox.ItemTemplate>
					<DataTemplate>
						<DataTemplate.Resources>
							<DataTemplate x:Key="ViewContent">
								<TextBlock Margin="5 0 0 0" VerticalAlignment="Center" Text="{Binding Name}"/>
							</DataTemplate>
							<DataTemplate x:Key="EditContent">
								<TextBox x:Name="editBox" Margin="5 0 0 0" Text="{Binding Name, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" FocusManager.FocusedElement="{Binding ElementName=editBox}" CaretIndex="{x:Static sys:Int32.MaxValue}">
									<TextBox.InputBindings>
										<KeyBinding Key="Enter" Command="{Binding DataContext.ColourEditBoxEnterCommand, RelativeSource={RelativeSource AncestorType=local:MainWindow}}"/>
									</TextBox.InputBindings>
								</TextBox>
							</DataTemplate>
						</DataTemplate.Resources>
						<StackPanel Orientation="Horizontal">
							<Border Width="18" Height="18" BorderThickness="1" BorderBrush="Black" CornerRadius="5">
								<Border.Background>
									<SolidColorBrush Color="{Binding Colour}"/>
								</Border.Background>
							</Border>
							<ContentPresenter Content="{Binding}">
								<ContentPresenter.Style>
									<Style TargetType="{x:Type ContentPresenter}">
										<Setter Property="ContentTemplate" Value="{StaticResource ViewContent}"/>
										<Style.Triggers>
											<MultiDataTrigger>
												<MultiDataTrigger.Conditions>
													<Condition Binding="{Binding DataContext.IsEdit, RelativeSource={RelativeSource AncestorType=local:MainWindow}}" Value="True"/>
													<Condition Binding="{Binding IsSelected, RelativeSource={RelativeSource AncestorType=ListBoxItem}}" Value="True"/>
												</MultiDataTrigger.Conditions>
												<Setter Property="ContentTemplate" Value="{StaticResource EditContent}"/>
											</MultiDataTrigger>
										</Style.Triggers>
									</Style>
								</ContentPresenter.Style>
							</ContentPresenter>
						</StackPanel>
					</DataTemplate>
				</ListBox.ItemTemplate>
			</ListBox>
			<!-- Saved colour controls -->
			<Grid Margin="0 4 0 0" Grid.Row="1">
				<Grid.Resources>
					<Style TargetType="{x:Type Button}">
						<Setter Property="Margin" Value="1"/>
					</Style>
				</Grid.Resources>
				<Grid.ColumnDefinitions>
					<ColumnDefinition Width="2*"/>
					<ColumnDefinition Width="2*"/>
					<ColumnDefinition Width="*"/>
				</Grid.ColumnDefinitions>
				<Grid.RowDefinitions>
					<RowDefinition Height="*"/>
					<RowDefinition Height="*"/>
				</Grid.RowDefinitions>
				<Button Content="Add" Command="{Binding AddColourCommand}"/>
				<Button Content="Remove" Grid.Column="1" Command="{Binding RemoveColourCommand}"/>
				<Button Content="Rename" Grid.Row="1" Command="{Binding RenameColourCommand}"/>
				<Button Content="Duplicate" Grid.Column="1" Grid.Row="1" Command="{Binding DuplicateButtonCommand}"/>
				<!-- These arrows are only temporary. -->
				<Button Content="↑" Grid.Column="2" Command="{Binding ColoursMoveUpButtonCommand}"/>
				<Button Content="↓" Grid.Column="2" Grid.Row="1" Command="{Binding ColoursMoveDownButtonCommand}"/>
			</Grid>
			<!-- Colour controls -->
			<StackPanel Grid.Row="2" Margin="0 5 0 0">
				<Button Width="100" FontSize="13" Content="Clear Colours" HorizontalAlignment="Left" Margin="0 3" Height="20"/>
				<Button Width="100" FontSize="13" Content="Export Colours" HorizontalAlignment="Left" Margin="0 3" Height="20"/>
				<Button Width="100" FontSize="13" Content="Import Colours" HorizontalAlignment="Left" Margin="0 3" Height="20"/>
			</StackPanel>
		</Grid>
	</Grid>
</Window>
